{"version":3,"file":"quests-779fea6d.js","sources":["../../src/models/footstep.model.ts","../../src/config/footstep.config.ts","../../src/footstep.ts","../../src/chatArea.ts","../../node_modules/@workadventure/quests/dist/quests.js","../../src/quests.ts"],"sourcesContent":["export enum MaterialType {\n  wood = \"wood\",\n  forest = \"forest\",\n  snow = \"snow\",\n  marble = \"marble\",\n  stone = \"stone\",\n  mud = \"mud\",\n  path = \"path\",\n  water = \"water\",\n  sand = \"sand\",\n  ice = \"ice\"\n}\n\nexport interface SoundArea {\n  name: string;\n  y: number;\n  x: number;\n  width?: number;\n  height?: number;\n  material?: MaterialType;\n}\n","import { SoundConfig } from \"@workadventure/iframe-api-typings/play/src/front/Api/Iframe/Sound/Sound\";\nimport { MaterialType } from \"../models/footstep.model\";\n\nexport const soundFiles: Record<MaterialType, string[]> = {\n  [MaterialType.wood]: [\n    \"wood_01_a.wav\",\n    \"wood_01_b.wav\",\n    \"wood_01_c.wav\",\n    \"wood_01_d.wav\",\n  ],\n  [MaterialType.forest]: [\n    \"forest_01_a.wav\",\n    \"forest_01_b.wav\",\n    \"forest_01_c.wav\",\n    \"forest_01_d.wav\",\n    \"forest_01_e.wav\",\n  ],\n  [MaterialType.snow]: [\n    \"snow_01_a.wav\",\n    \"snow_01_b.wav\",\n    \"snow_01_c.wav\",\n    \"snow_01_d.wav\",\n  ],\n  [MaterialType.marble]: [\n    \"marble_01_a.wav\",\n    \"marble_01_b.wav\",\n    \"marble_01_c.wav\",\n    \"marble_01_d.wav\",\n  ],\n  [MaterialType.mud]: [\n    \"mud_01_a.wav\",\n    \"mud_01_b.wav\",\n    \"mud_01_c.wav\",\n    \"mud_01_d.wav\",\n  ],\n  [MaterialType.path]: [\n    \"path_01_a.wav\",\n    \"path_01_b.wav\",\n    \"path_01_c.wav\",\n    \"path_01_d.wav\",\n    \"path_01_e.wav\",\n  ],\n  [MaterialType.stone]: [\n    \"stone_01_a.wav\",\n    \"stone_01_b.wav\",\n    \"stone_01_c.wav\",\n    \"stone_01_d.wav\",\n    \"stone_01_e.wav\",\n  ],\n  [MaterialType.water]: [\n    \"water_01_a.wav\",\n    \"water_01_b.wav\",\n    //\"water_01_c.wav\" (Doesnt sound good)\n  ],\n  [MaterialType.sand]: [\n    \"sand_01_a.wav\",\n    \"sand_01_b.wav\",\n    \"sand_01_c.wav\",\n    //\"water_01_c.wav\" (Doesnt sound good)\n  ],\n  [MaterialType.ice]: [\n    \"ice_01.wav\",\n    \"ice_02.wav\",\n    \"ice_03.wav\",\n    \"ice_04.wav\",\n  ],\n\n\n};\n///some sounds are missing, but you can add them here\nexport const audioConfig: SoundConfig = {\n  volume: 0.05,\n  loop: false,\n  rate: 1.5,\n  detune: 1,\n  delay: 0,\n  seek: 0,\n  mute: false,\n};\n","import { Sound } from \"@workadventure/iframe-api-typings\";\nimport { getLayersMap } from \"@workadventure/scripting-api-extra/dist\";\nimport { audioConfig, soundFiles } from \"./config/footstep.config\";\nimport { MaterialType, SoundArea } from \"./models/footstep.model\";\n\nlet mySound: Sound;\nlet stepSoundAreas: any[] = [];\n\nfunction playRandomSound(material: MaterialType) {\n  if (!soundFiles[material]) return;\n\n  const randomIndex = Math.floor(Math.random() * soundFiles[material].length);\n  mySound = WA.sound.loadSound(\n    `https://komponentab.github.io/Avatar-based-scientific-writing/sounds/${soundFiles[material][randomIndex]}`\n  );\n  mySound.play(audioConfig);\n}\n\nasync function getStepSoundAreas(): Promise<SoundArea[]> {\n  try {\n    const layers = await getLayersMap();\n    const areas = [];\n\n    for (const layer of layers.values()) {\n      if (layer.type === \"objectgroup\") {\n        for (const object of layer.objects) {\n          if (!object.properties) continue;\n          if (\n            object.properties.some(\n              (prop) => prop.name === \"stepSound\" && prop.value === true\n            )\n          ) {\n            const material = object.properties.find(\n              (prop) => prop.name === \"material\"\n            )?.value as MaterialType;\n\n            if (soundFiles[material]) {\n              areas.push({\n                name: object.name,\n                x: object.x,\n                y: object.y,\n                width: object.width,\n                height: object.height,\n                material: material,\n              });\n            }\n          }\n        }\n      }\n    }\n    console.log(\"Found step sound areas:\", areas);\n    return areas;\n  } catch (error) {\n    console.error(\"Error while getting step sound areas:\", error);\n    return [];\n  }\n}\n\nfunction isInsideArea(\n  playerPosition: { x: number; y: number },\n  area: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  }\n) {\n  return (\n    playerPosition.x >= area.x &&\n    playerPosition.x <= area.x + area.width &&\n    playerPosition.y >= area.y &&\n    playerPosition.y <= area.y + area.height\n  );\n}\n\nasync function checkPlayerMaterial(playerPosition: { x: number; y: number }) {\n  try {\n    for (const area of stepSoundAreas) {\n      if (isInsideArea(playerPosition, area)) {\n        return area.material;\n      }\n    }\n    return null;\n  } catch (error) {\n    console.error(\"Error while checking player material:\", error);\n    return null;\n  }\n}\n\nWA.onInit().then(async () => {\n  stepSoundAreas = await getStepSoundAreas();\n});\n\nexport { checkPlayerMaterial, mySound, playRandomSound };\n","import { getLayersMap } from \"@workadventure/scripting-api-extra/dist\";\n\ninterface ChatArea {\n  name: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  chatText: string;\n  npcName: string;\n  triggerQuest: string;\n}\n\nasync function getChatAreas(): Promise<ChatArea[]> {\n  try {\n    const layers = await getLayersMap();\n    const areas: ChatArea[] = [];\n\n    for (const layer of layers.values()) {\n      if (layer.type === \"objectgroup\") {\n        for (const object of layer.objects) {\n          if (!object.properties) continue;\n          if (\n            object.properties.some(\n              (prop) => prop.name === \"isNpc\" && prop.value === true\n            )\n          ) {\n            const chatText = object.properties.find(\n              (prop) => prop.name === \"chatText\"\n            )?.value;\n            const npcName = object.properties.find(\n              (prop) => prop.name === \"npcName\"\n            )?.value;\n\n            const triggerQuest = object.properties.find(\n              (prop) => prop.name === \"triggerQuest\"\n            )?.value ?? \"\";\n\n            if (chatText && npcName) {\n              areas.push({\n                name: object.name,\n                x: object.x,\n                y: object.y,\n                width: object.width ?? 0,\n                height: object.height ?? 0,\n                chatText: String(chatText),\n                npcName: String(npcName),\n                triggerQuest: String(triggerQuest),\n              });\n            }\n          }\n        }\n      }\n    }\n    console.log(\"Found chat areas:\", areas);\n    return areas;\n  } catch (error) {\n    console.error(\"Error while getting chat areas:\", error);\n    return [];\n  }\n}\n\nexport { getChatAreas };\n","let r = \"https://admin.workadventu.re\";\nfunction c(e) {\n  r = e;\n}\nfunction n() {\n  const e = WA.player.userRoomToken;\n  if (e === void 0)\n    throw new Error(\n      \"No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).\"\n    );\n  return e;\n}\nasync function d(e) {\n  const t = new URL(`/api/quests/${e}`, r);\n  t.search = new URLSearchParams({ room: WA.room.id }).toString();\n  const o = await fetch(t, {\n    method: \"GET\",\n    headers: {\n      Authorization: n()\n    }\n  });\n  if (!o.ok)\n    throw new Error(`An error occurred. HTTP Code: ${o.status} ${o.statusText}.`);\n  return await o.json();\n}\nasync function w(e) {\n  const t = new URL(`/api/quests/${e}/leaderboard`, r);\n  t.search = new URLSearchParams({ room: WA.room.id }).toString();\n  const o = await fetch(t, {\n    method: \"GET\",\n    headers: {\n      Authorization: n()\n    }\n  });\n  if (!o.ok)\n    throw new Error(`An error occurred. HTTP Code: ${o.status} ${o.statusText}.`);\n  return await o.json();\n}\nfunction h(e) {\n  const t = new URL(`/quests/${e}/leaderboard`, r);\n  return t.search = new URLSearchParams({ room: WA.room.id, token: n() }).toString(), t;\n}\nasync function l(e, t) {\n  if (!WA.player.isLogged)\n    throw new Error(\"You must be logged to gain XP.\");\n  const o = new URL(`/api/quests/${e}/level-up`, r), a = await fetch(o, {\n    method: \"POST\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: n()\n    },\n    body: JSON.stringify({ xp: t })\n  });\n  if (!a.ok)\n    throw new Error(`An error occurred. HTTP Code: ${a.status} ${a.statusText}.`);\n  const s = await a.json();\n  return s.awardedBadges.length > 0 && (async () => {\n    for (const i of s.awardedBadges)\n      await u(e, i);\n  })().catch((i) => {\n    console.error(i);\n  }), s;\n}\nasync function u(e, t) {\n  const o = new URL(`/quests/${e}/badge/${t}/congratulations`, r);\n  o.search = new URLSearchParams({ token: n() }).toString(), await WA.ui.website.open({\n    url: o.toString(),\n    position: {\n      vertical: \"middle\",\n      horizontal: \"middle\"\n    },\n    allowApi: !0,\n    visible: !0,\n    size: {\n      width: \"100%\",\n      height: \"100%\"\n    }\n  });\n}\nexport {\n  w as getLeaderboard,\n  h as getLeaderboardURL,\n  d as getQuest,\n  l as levelUp,\n  c as setQuestBaseUrl\n};\n","import { levelUp } from \"@workadventure/quests\";\n\nconst quests = [\n    // Notlog\n    {\n        questName: 'Einführung in Notlog',\n        questId: 'quest1',\n        questDescription: 'Triff Prof. McDongle am Eingang von Notlog.',\n        questXp: 100,\n        requireQuest: null,\n        questKey: 'notlog'\n    },\n    {\n        questName: 'Erkundung des Saals',\n        questId: 'quest2',\n        questDescription: 'Sprich mit Prof. Mumblecore am nördlichen Ende der großen Halle.',\n        questXp: 150,\n        requireQuest: 'quest1',\n        questKey: 'notlog'\n    },\n    {\n        questName: 'Laborbesuch',\n        questId: 'quest3',\n        questDescription: 'Geh runter ins Labor und sprich mit Prof. Sake.',\n        questXp: 200,\n        requireQuest: 'quest2',\n        questKey: 'notlog'\n    },\n    {\n        questName: 'Das Video im Labor ansehen',\n        questId: 'quest4',\n        questDescription: 'Sehen dir das Video im Labor an.',\n        questXp: 50,\n        requireQuest: 'quest3',\n        questKey: 'notlog'\n    },\n    {\n        questName: 'Betreten Sie den Matrix Hub',\n        questId: 'quest5',\n        questDescription: 'Verlasse Notlog und betrete den Matrix Hub.',\n        questXp: 250,\n        requireQuest: 'quest4',\n        questKey: 'notlog'\n    },\n    // Matrix Hub\n\n{\n    questName: \"Durch das Chaos im Labor navigieren\",\n    questId: \"modul2_quest1\",\n    questDescription: \"Komm mit der Unordnung im Farblabor zurecht und finde heraus, wer das Chaos angerichtet hat.\",\n    questXp: 10,\n    requireQuest: \"quest5\",\n    questKey: \"modul2\"\n},\n{\n    questName: \"materialien ordnen\",\n    questId: \"modul2_quest2\",\n    questDescription: \"Bringe die Materialien von Alex in Ordnung und erhalte mehr Einblicke in den Kurs 'Wissenschaftliches Arbeiten'.\",\n    questXp: 10,\n    requireQuest: \"modul2_quest1\",\n    questKey: \"modul2\"\n},\n{\n    questName: \"Meistere 3.2\",\n    questId: \"modul2_quest3\",\n    questDescription: \"Schaffe es, 3.2 zu bewältigen, und erhalte Respekt für deinen Einsatz.\",\n    questXp: 10,\n    requireQuest: \"modul2_quest2\",\n    questKey: \"modul2\"\n},\n{\n    questName: \"Überwinde 3.3\",\n    questId: \"modul2_quest4\",\n    questDescription: \"Meistere das nächste Kapitel, 3.3, und lerne noch mehr von Alex' Materialien.\",\n    questXp: 10,\n    requireQuest: \"modul2_quest3\",\n    questKey: \"modul2\"\n},\n\n// Modul 3\n];\n\n\nexport { quests, levelUp };"],"names":["MaterialType","soundFiles","audioConfig","mySound","stepSoundAreas","playRandomSound","material","randomIndex","getStepSoundAreas","layers","getLayersMap","areas","layer","object","prop","_a","error","isInsideArea","playerPosition","area","checkPlayerMaterial","getChatAreas","chatText","npcName","_b","triggerQuest","_c","r","n","l","o","i","u","quests"],"mappings":"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,CACR,SAAU,SACV,WAAY,QACb,EACD,SAAU,GACV,QAAS,GACT,KAAM,CACJ,MAAO,OACP,OAAQ,MACT,CACL,CAAG,CACH,CC7EA,MAAMG,EAAS,CAEX,CACI,UAAW,uBACX,QAAS,SACT,iBAAkB,8CAClB,QAAS,IACT,aAAc,KACd,SAAU,QACd,EACA,CACI,UAAW,sBACX,QAAS,SACT,iBAAkB,mEAClB,QAAS,IACT,aAAc,SACd,SAAU,QACd,EACA,CACI,UAAW,cACX,QAAS,SACT,iBAAkB,kDAClB,QAAS,IACT,aAAc,SACd,SAAU,QACd,EACA,CACI,UAAW,6BACX,QAAS,SACT,iBAAkB,mCAClB,QAAS,GACT,aAAc,SACd,SAAU,QACd,EACA,CACI,UAAW,8BACX,QAAS,SACT,iBAAkB,8CAClB,QAAS,IACT,aAAc,SACd,SAAU,QACd,EAGJ,CACI,UAAW,sCACX,QAAS,gBACT,iBAAkB,+FAClB,QAAS,GACT,aAAc,SACd,SAAU,QACd,EACA,CACI,UAAW,qBACX,QAAS,gBACT,iBAAkB,mHAClB,QAAS,GACT,aAAc,gBACd,SAAU,QACd,EACA,CACI,UAAW,eACX,QAAS,gBACT,iBAAkB,yEAClB,QAAS,GACT,aAAc,gBACd,SAAU,QACd,EACA,CACI,UAAW,gBACX,QAAS,gBACT,iBAAkB,gFAClB,QAAS,GACT,aAAc,gBACd,SAAU,QACd,CAGA","x_google_ignoreList":[4]}