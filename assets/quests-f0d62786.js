import{a as v}from"./quests-97058ec9.js";var t=(o=>(o.wood="wood",o.forest="forest",o.snow="snow",o.marble="marble",o.stone="stone",o.mud="mud",o.path="path",o.water="water",o.sand="sand",o.ice="ice",o))(t||{});const w={[t.wood]:["wood_01_a.wav","wood_01_b.wav","wood_01_c.wav","wood_01_d.wav"],[t.forest]:["forest_01_a.wav","forest_01_b.wav","forest_01_c.wav","forest_01_d.wav","forest_01_e.wav"],[t.snow]:["snow_01_a.wav","snow_01_b.wav","snow_01_c.wav","snow_01_d.wav"],[t.marble]:["marble_01_a.wav","marble_01_b.wav","marble_01_c.wav","marble_01_d.wav"],[t.mud]:["mud_01_a.wav","mud_01_b.wav","mud_01_c.wav","mud_01_d.wav"],[t.path]:["path_01_a.wav","path_01_b.wav","path_01_c.wav","path_01_d.wav","path_01_e.wav"],[t.stone]:["stone_01_a.wav","stone_01_b.wav","stone_01_c.wav","stone_01_d.wav","stone_01_e.wav"],[t.water]:["water_01_a.wav","water_01_b.wav"],[t.sand]:["sand_01_a.wav","sand_01_b.wav","sand_01_c.wav"],[t.ice]:["ice_01.wav","ice_02.wav","ice_03.wav","ice_04.wav"]},l={volume:.05,loop:!1,rate:1.5,detune:1,delay:0,seek:0,mute:!1};let i,d=[];function g(o){if(!w[o])return;const e=Math.floor(Math.random()*w[o].length);i=WA.sound.loadSound(`https://komponentab.github.io/Avatar-based-scientific-writing/sounds/${w[o][e]}`),i.play(l)}async function h(){var o;try{const e=await v(),r=[];for(const s of e.values())if(s.type==="objectgroup"){for(const a of s.objects)if(a.properties&&a.properties.some(n=>n.name==="stepSound"&&n.value===!0)){const n=(o=a.properties.find(u=>u.name==="material"))==null?void 0:o.value;w[n]&&r.push({name:a.name,x:a.x,y:a.y,width:a.width,height:a.height,material:n})}}return console.log("Found step sound areas:",r),r}catch(e){return console.error("Error while getting step sound areas:",e),[]}}function f(o,e){return o.x>=e.x&&o.x<=e.x+e.width&&o.y>=e.y&&o.y<=e.y+e.height}async function b(o){try{for(const e of d)if(f(o,e))return e.material;return null}catch(e){return console.error("Error while checking player material:",e),null}}WA.onInit().then(async()=>{d=await h()});let _="https://admin.workadventu.re";function c(){const o=WA.player.userRoomToken;if(o===void 0)throw new Error("No userRoomToken found. The quests plugin can only work with WorkAdventure SAAS edition (at https://play.workadventu.re).");return o}async function y(o,e){if(!WA.player.isLogged)throw new Error("You must be logged to gain XP.");const r=new URL(`/api/quests/${o}/level-up`,_),s=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:c()},body:JSON.stringify({xp:e})});if(!s.ok)throw new Error(`An error occurred. HTTP Code: ${s.status} ${s.statusText}.`);const a=await s.json();return a.awardedBadges.length>0&&(async()=>{for(const n of a.awardedBadges)await m(o,n)})().catch(n=>{console.error(n)}),a}async function m(o,e){const r=new URL(`/quests/${o}/badge/${e}/congratulations`,_);r.search=new URLSearchParams({token:c()}).toString(),await WA.ui.website.open({url:r.toString(),position:{vertical:"middle",horizontal:"middle"},allowApi:!0,visible:!0,size:{width:"100%",height:"100%"}})}export{b as c,y as l,i as m,g as p};
//# sourceMappingURL=quests-f0d62786.js.map
